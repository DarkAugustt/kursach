# АврораТур

## Система бронирования автобилетов
Цель данного проекта заключается в разработке веб-приложения, предназначенного для удобного бронирования автобилетов. Пользователи смогут легко выбирать желаемое направление, определять предпочтительные даты и рейсы, а также осуществлять процесс бронирования с максимальным комфортом.
# Техническое задание

## Пользовательские сценарии
##### Сценарии работы пользователя
1. Неавторизованный пользователь заходит на главную страницу. При посещении сайта он ограничен в возможности выполнения любых действий, за исключением регистрации или входа.
2. При нажатии на кнопку авторизации происходит вход/регистрация через Телеграм. 
3. При переходе на страницу бронирования у пользователя есть возможность выбрать дату и маршрут отправления.
4. Если рейсы, соответствующие введённым данным, существуют, то пользователь увидит их список.
5. После выбора рейса пользователю предоставляется выбор места в автобусе. Уже забронированные места высвечены не будут.
6. После выполнения бронированния пользователь может увидеть свои забронированные места в личном кабинете.
##### Сценарии работы администратора
1. В панель администратора можно попасть через профиль. Кнопка для перехода видна только пользователю с ролью администратора.
2. В панели можно посмотреть на всех зарегистрированных пользователей, выдать и забрать роль администратора, удалить пользователя
3. Администратор может добавить и отредактировать данные об автобусе, отправлении и маршруте.
4. Для просмотра данных об бронированиях администратор может перейти на соответствующую страницу.
## Функциональные требования:
### Система авторизации:
1. Реализация авторизации пользователей через мессенджер Telegram.
2. Защита от несанкционированного доступа.
### Бронирование билета:
1. Возможность выбора даты и маршрута.
2. Возможность выбора места.
3. Возможность отмены бронирования.
### Просмотр истории бронирований:
1. Отображение списка предыдущих бронирований пользователя.
2. Детали каждого бронирования.
## Технологический стек:
### Backend:
1. Язык программирования: PHP.
2. Система управления базами данных: MySQL.
### Frontend:
1. Языки программирования: JavaScript, HTML, CSS.
2. Использование фреймворка Bootstrap для улучшения дизайна и адаптивности.
### Интеграция с мессенджером Telegram:
 Использование Telegram API для реализации системы авторизации.
## Интерфейс
![Изображение](https://github.com/DarkAugustt/kursach/blob/main/Интерфейс.png)
## Диаграммы
![Изображение](https://github.com/DarkAugustt/kursach/blob/main/diagram.jpg)
![Изображение](https://github.com/DarkAugustt/kursach/blob/main/umldiag.png)
## Описание таблиц базы данных

##### Таблица autos
id (Первичный ключ, тип данных: int): Уникальный идентификатор автобуса.
auto_name (Тип данных: varchar): Название или модель автобуса
seats (Тип данных: int): Количество сидений в автобусе, представленное в виде целого числа.

##### Таблица routes
id (Первичный ключ, тип данных: int, AUTO_INCREMENT): Уникальный идентификатор маршрута, автоматически увеличиваемый при добавлении новой записи.
departure_station (Тип данных: varchar): Название станции отправления маршрута, представленное в виде строки переменной длины.
arrival_station (Тип данных: varchar): Название станции прибытия маршрута, представленное в виде строки переменной длины.

##### Таблица schedule
id (Первичный ключ, тип данных: int): Уникальный идентификатор записи.
auto_id (Тип данных: int): Идентификатор автомобиля, связанный с каким-то конкретным рейсом или маршрутом.
route_id (Тип данных: int): Идентификатор маршрута, связанного с данным временем и статусом.
departure_time (Тип данных: time): Время отправления.
arrival_time (Тип данных: time): Время прибытия.
departure_date (Тип данных: date): Дата отправления.
arrival_date (Тип данных: date): Дата прибытия.
status (Тип данных: varchar): Статус автомобиля на маршруте, представленный в виде строки переменной длины

##### Таблица tickets
id (Первичный ключ, тип данных: int): Уникальный идентификатор записи.
schedule_id (Тип данных: int): Идентификатор рейса в расписании.
user_id (Тип данных: int): Идентификатор пользователя, который забронировал место.
seat_number (Тип данных: int): Номер забронированного места.
status (Тип данных: varchar): Статус бронирования, представленный в виде строки переменной длины.
date (Тип данных: date): Дата бронирования.

##### Таблица users
id (Первичный ключ, тип данных: int): Уникальный идентификатор пользователя.
first_name (Тип данных: varchar): Имя пользователя, представленное в виде строки переменной длины.
last_name (Тип данных: varchar): Фамилия пользователя, представленная в виде строки переменной длины.
telegram_id (Тип данных: varchar): Идентификатор пользователя в Telegram.
telegram_username (Тип данных: varchar): Псевдоним пользователя в Telegram.
profile_picture (Тип данных: varchar): Ссылка на изображение профиля пользователя.
auth_date (Тип данных: int): Дата авторизации пользователя.
is_admin (Тип данных: tinyint): Флаг, указывающий, является ли пользователь администратором (1 - да, 0 - нет).

## Документация
Swagger-документация этого метода служит надежным руководством для разработчиков, которые стремятся взаимодействовать с системой, используя стандартные и эффективные методы. Здесь мы предоставляем подробное описание параметров запросов, форматов ответов и основных сценариев использования. Полный файл доступен по ссылке https://github.com/DarkAugustt/kursach/blob/main/openapi.yaml. Вот фрагмент кода:
/admin/schedule:
    get:
      summary: Получить все рейсы
      responses:
        '200':
          description: Успешный запрос
    post:
      summary: Добавить новый рейс
      responses:
        '201':
          description: Рейс успешно добавлен
  /admin/schedule/{id}:
    get:
      summary: Получить информацию о конкретном рейсе
      parameters:
        - name: id
          in: path
          required: true
          description: Идентификатор рейса
          schema:
            type: integer
      responses:
        '200':
          description: Успешный запрос
    put:
      summary: Обновить информацию о рейсе
      parameters:
        - name: id
          in: path
          required: true
          description: Идентификатор рейса
          schema:
            type: integer
      responses:
        '200':
          description: Рейс успешно обновлен
    delete:
      summary: Удалить рейс
      parameters:
        - name: id
          in: path
          required: true
          description: Идентификатор рейса
          schema:
            type: integer
      responses:
        '204':
          description: Рейс успешно удален

## Развёртывание 
Для развёртывания у себя или на сервере в директории /var/www/html в терминале пропишите git clone https://github.com/DarkAugustt/BusBooking.git (доступ ограничен на некоторое время). В phpmyadmin импортируйте дамп базы данных. Настройте в database/config.php необходимые параметры. Для авторизации через Telegram создайте у @BotFather бота и укажите /setdomain с вашим доменом.
